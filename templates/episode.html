{% extends 'base.html' %}

{% block title %}{{ episode.title }}{% endblock %}

{% block content %}
    <div class="episode-detail">
        <h2>{{ episode.title }}</h2>
        
        <div class="episode-meta">
            <span class="date">发布于: {{ episode.pub_date.strftime('%Y-%m-%d') }}</span>
        </div>
        
        <!-- 密码保护检查 -->
        {% if episode.password and not authenticated %}
            <div class="password-protection">
                <h3>此内容受密码保护</h3>
                <form method="post">
                    <div class="form-group">
                        <label for="password">请输入密码访问此集:</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    {% if error %}
                        <div class="error-message">{{ error }}</div>
                    {% endif %}
                    <button type="submit" class="button">解锁内容</button>
                </form>
            </div>
        {% else %}
            <!-- 播客内容 -->
            <div class="episode-description">
                {{ episode.description|safe }}
            </div>
            
            <div class="audio-player">
                <audio controls>
                    <source src="{{ url_for('media', filename=episode.audio_file) }}" type="audio/mpeg">
                    您的浏览器不支持音频播放器。
                </audio>
                
                <div class="download-links">
                    <a href="{{ url_for('media', filename=episode.audio_file) }}" download class="button">下载音频 (MP3)</a>
                </div>
            </div>
        {% endif %}
        
        <a href="{{ url_for('index') }}" class="back-link">← 返回播客列表</a>
    </div>
{% endblock %}